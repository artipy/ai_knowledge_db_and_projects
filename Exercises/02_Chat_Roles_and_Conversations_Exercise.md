# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ ‚Ññ2: –†–æ–ª–∏ –≤ —á–∞—Ç–∞—Ö –∏ –º–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏

## –¶–µ–ª—å –∑–∞–¥–∞–Ω–∏—è

–û—Å–≤–æ–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —Ä–æ–ª–µ–π (system, user, assistant) –≤ OpenAI API, –Ω–∞—É—á–∏—Ç—å—Å—è —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –ø—Ä–∏–º–µ–Ω—è—Ç—å —Ä–æ–ª–∏ –¥–ª—è few-shot prompting –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –º–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

- [[OpenAI_API/Chat_Roles_and_Multi_Turn_Conversations|–†–æ–ª–∏ –≤ —á–∞—Ç–∞—Ö –∏ –º–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏]]
- [[OpenAI_API/Working_with_OpenAI_API_in_Python|–†–∞–±–æ—Ç–∞ —Å OpenAI API –≤ Python]]
- [[OpenAI_API/Introduction_to_OpenAI_API|–í–≤–µ–¥–µ–Ω–∏–µ –≤ OpenAI API]]

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `openai` –∏ `python-dotenv`
- –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π `.env` —Ñ–∞–π–ª —Å API –∫–ª—é—á–æ–º
- –í—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ [[Exercises/01_OpenAI_API_Text_Processing_Exercise|–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ ‚Ññ1]]
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ —Ä–∞–±–æ—Ç—ã —Å OpenAI API

---

## –ß–∞—Å—Ç—å 1: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—É—é —Ä–æ–ª—å (15 –º–∏–Ω—É—Ç)

### –ó–∞–¥–∞—á–∞ 1.1: –¢—Ä–∏ —Å—Ç–∏–ª—è –æ–±—â–µ–Ω–∏—è

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**

–°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –≤–æ–ø—Ä–æ—Å –≤ —Ç—Ä–µ—Ö —Ä–∞–∑–Ω—ã—Ö —Å—Ç–∏–ª—è—Ö, –∏—Å–ø–æ–ª—å–∑—É—è —Ä–∞–∑–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è.

**–í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
```
–ß—Ç–æ —Ç–∞–∫–æ–µ —Ä–µ–∫—É—Ä—Å–∏—è –≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏?
```

**–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–æ–ª–∏ –¥–ª—è —Ç—Ä–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:**

1. **–°—Ç—Ä–æ–≥–∏–π –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞**: —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π, –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ—Ä–º–∏–Ω—ã
2. **–î—Ä—É–≥-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç**: –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å, –ø—Ä–æ—Å—Ç—ã–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è, –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–Ω–≥
3. **–î–µ—Ç—Å–∫–∏–π —É—á–∏—Ç–µ–ª—å**: –æ–±—ä—è—Å–Ω—è–µ—Ç –Ω–∞ –ø—Ä–∏–º–µ—Ä–∞—Ö –∏–∑ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π –∂–∏–∑–Ω–∏, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
=== –°–¢–ò–õ–¨ 1: –°–¢–†–û–ì–ò–ô –ü–†–ï–ü–û–î–ê–í–ê–¢–ï–õ–¨ ===
[–§–æ—Ä–º–∞–ª—å–Ω—ã–π –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–π –æ—Ç–≤–µ—Ç]

=== –°–¢–ò–õ–¨ 2: –î–†–£–ì-–ü–†–û–ì–†–ê–ú–ú–ò–°–¢ ===
[–ù–µ—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π –¥—Ä—É–∂–µ—Å–∫–∏–π –æ—Ç–≤–µ—Ç]

=== –°–¢–ò–õ–¨ 3: –î–ï–¢–°–ö–ò–ô –£–ß–ò–¢–ï–õ–¨ ===
[–ü—Ä–æ—Å—Ç–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏]
```

**–®–∞–±–ª–æ–Ω –∫–æ–¥–∞:**
```python
from openai import OpenAI
from dotenv import load_dotenv
import os

load_dotenv()

client = OpenAI(
    api_key=os.getenv("GEMINI_TOKEN"),
    base_url=os.getenv("BASE_URL")
)

question = "–ß—Ç–æ —Ç–∞–∫–æ–µ —Ä–µ–∫—É—Ä—Å–∏—è –≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏?"

# –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç—Ä–∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è
system_messages = {
    "–°—Ç—Ä–æ–≥–∏–π –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å": """–¢—ã —Å—Ç—Ä–æ–≥–∏–π –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞...""",
    "–î—Ä—É–≥-–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç": """...""",
    "–î–µ—Ç—Å–∫–∏–π —É—á–∏—Ç–µ–ª—å": """..."""
}

# –í–∞—à –∫–æ–¥ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤
for style, sys_msg in system_messages.items():
    # –°–æ–∑–¥–∞–π—Ç–µ –∑–∞–ø—Ä–æ—Å —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–Ω–æ–π —Ä–æ–ª—å—é
    # –í—ã–≤–µ–¥–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    pass
```

---

## –ß–∞—Å—Ç—å 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥—Ä–∞–Ω–∏—Ü –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π (20 –º–∏–Ω—É—Ç)

### –ó–∞–¥–∞—á–∞ 2.1: –ß–∞—Ç-–±–æ—Ç –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –∫–ª–∏–Ω–∏–∫–∏

**–°—Ü–µ–Ω–∞—Ä–∏–π**: –í—ã —Å–æ–∑–¥–∞–µ—Ç–µ —á–∞—Ç-–±–æ—Ç–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏ –Ω–∞ –ø—Ä–∏–µ–º –≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫—É—é –∫–ª–∏–Ω–∏–∫—É. –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –ø–æ–º–æ–≥–∞—Ç—å —Å –∑–∞–ø–∏—Å—å—é, –Ω–æ **–Ω–µ –¥–æ–ª–∂–µ–Ω** –¥–∞–≤–∞—Ç—å –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –∏–ª–∏ –¥–∏–∞–≥–Ω–æ–∑—ã.

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**

1. –°–æ–∑–¥–∞–π—Ç–µ —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ:
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –±–æ—Ç–∞ –∫–∞–∫ –ø–æ–º–æ—â–Ω–∏–∫–∞ –ø–æ –∑–∞–ø–∏—Å–∏ –Ω–∞ –ø—Ä–∏–µ–º
   - –û–±—ä—è—Å–Ω—è–µ—Ç, —á—Ç–æ –±–æ—Ç –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º –∏ –∑–∞–ø–∏—Å—å—é
   - **–°—Ç—Ä–æ–≥–æ –∑–∞–ø—Ä–µ—â–∞–µ—Ç** –¥–∞–≤–∞—Ç—å –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã, –¥–∏–∞–≥–Ω–æ–∑—ã –∏–ª–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ª–µ–∫–∞—Ä—Å—Ç–≤
   - –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–æ–ª—É—á–∏—Ç—å –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —Å–æ–≤–µ—Ç, –±–æ—Ç –¥–æ–ª–∂–µ–Ω –≤–µ–∂–ª–∏–≤–æ –æ—Ç–∫–∞–∑–∞—Ç—å –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–∏–µ–º –∫ –≤—Ä–∞—á—É

2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –±–æ—Ç–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö:

```python
test_questions = [
    "–ö–∞–∫–∏–µ –≤—Ä–∞—á–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –∫–ª–∏–Ω–∏–∫–µ?",  # –î–æ–ø—É—Å—Ç–∏–º—ã–π –≤–æ–ø—Ä–æ—Å
    "–ó–∞–ø–∏—à–∏ –º–µ–Ω—è –∫ —Ç–µ—Ä–∞–ø–µ–≤—Ç—É –Ω–∞ –∑–∞–≤—Ç—Ä–∞",  # –î–æ–ø—É—Å—Ç–∏–º—ã–π –≤–æ–ø—Ä–æ—Å
    "–£ –º–µ–Ω—è –±–æ–ª–∏—Ç –≥–æ–ª–æ–≤–∞, —á—Ç–æ –º–Ω–µ –ø—Ä–∏–Ω—è—Ç—å?",  # –ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π - –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —Å–æ–≤–µ—Ç
    "–≠—Ç–æ —Å–∏–º–ø—Ç–æ–º—ã –≥—Ä–∏–ø–ø–∞ –∏–ª–∏ –ø—Ä–æ—Å—Ç—É–¥—ã?",  # –ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π - –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
    "–ö–∞–∫–æ–π –≥—Ä–∞—Ñ–∏–∫ —Ä–∞–±–æ—Ç—ã –∫–ª–∏–Ω–∏–∫–∏?",  # –î–æ–ø—É—Å—Ç–∏–º—ã–π –≤–æ–ø—Ä–æ—Å
    "–ú–æ–∂–Ω–æ –ª–∏ –º–Ω–µ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∞—Å–ø–∏—Ä–∏–Ω?"  # –ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π - —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ª–µ–∫–∞—Ä—Å—Ç–≤
]
```

3. –í—ã–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–≤–∞—Ç—å –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
=== –í–û–ü–†–û–° 1 ===
Q: –ö–∞–∫–∏–µ –≤—Ä–∞—á–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –∫–ª–∏–Ω–∏–∫–µ?
A: [–ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç –æ –≤—Ä–∞—á–∞—Ö –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —É—Ç–æ—á–Ω–∏—Ç—å]

=== –í–û–ü–†–û–° 2 ===
Q: –ó–∞–ø–∏—à–∏ –º–µ–Ω—è –∫ —Ç–µ—Ä–∞–ø–µ–≤—Ç—É –Ω–∞ –∑–∞–≤—Ç—Ä–∞
A: [–ü–æ–º–æ—â—å —Å –∑–∞–ø–∏—Å—å—é]

=== –í–û–ü–†–û–° 3 ===
Q: –£ –º–µ–Ω—è –±–æ–ª–∏—Ç –≥–æ–ª–æ–≤–∞, —á—Ç–æ –º–Ω–µ –ø—Ä–∏–Ω—è—Ç—å?
A: [–û–¢–ö–ê–ó —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –∫ –≤—Ä–∞—á—É]

...
```

**–®–∞–±–ª–æ–Ω –∫–æ–¥–∞:**
```python
system_message = """
–¢—ã –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –∫–ª–∏–Ω–∏–∫–∏ "–ó–¥–æ—Ä–æ–≤—å–µ".

–¢–≤–æ–∏ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏:
- –ü–æ–º–æ–≥–∞—Ç—å –ø–∞—Ü–∏–µ–Ω—Ç–∞–º –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–∏–µ–º
- –ò–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –æ –≥—Ä–∞—Ñ–∏–∫–µ —Ä–∞–±–æ—Ç—ã –∏ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤—Ä–∞—á–∞—Ö
- –û—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã

–°–¢–†–û–ì–û –ó–ê–ü–†–ï–©–ï–ù–û:
- –î–∞–≤–∞—Ç—å –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- –°—Ç–∞–≤–∏—Ç—å –¥–∏–∞–≥–Ω–æ–∑—ã
- –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –ª–µ–∫–∞—Ä—Å—Ç–≤–∞ –∏–ª–∏ –ª–µ—á–µ–Ω–∏–µ

–ï—Å–ª–∏ –ø–∞—Ü–∏–µ–Ω—Ç —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —Å–æ–≤–µ—Ç, –≤–µ–∂–ª–∏–≤–æ –æ—Ç–∫–∞–∂–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–∏ –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–∏–µ–º –∫ –≤—Ä–∞—á—É.
"""

test_questions = [...]

# –í–∞—à –∫–æ–¥ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
for i, question in enumerate(test_questions, 1):
    # –°–æ–∑–¥–∞–π—Ç–µ –∑–∞–ø—Ä–æ—Å
    # –í—ã–≤–µ–¥–∏—Ç–µ –≤–æ–ø—Ä–æ—Å –∏ –æ—Ç–≤–µ—Ç
    pass
```

---

## –ß–∞—Å—Ç—å 3: Few-Shot Prompting —á–µ—Ä–µ–∑ —Ä–æ–ª–∏ (20 –º–∏–Ω—É—Ç)

### –ó–∞–¥–∞—á–∞ 3.1: –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ –≤ JSON

**–°—Ü–µ–Ω–∞—Ä–∏–π**: –í—ã —Ö–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã –º–æ–¥–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–Ω–∏–≥–∞—Ö –≤ —Å—Ç—Ä–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º JSON —Ñ–æ—Ä–º–∞—Ç–µ.

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**

1. –°–æ–∑–¥–∞–π—Ç–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –¥–∏–∞–ª–æ–≥ (user-assistant) —Å –¥–≤—É–º—è –ø—Ä–∏–º–µ—Ä–∞–º–∏, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–º–∏ –∂–µ–ª–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞

2. –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ—Ä–æ–≤ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –Ω–æ–≤–æ–π –∫–Ω–∏–≥–µ

**–ü—Ä–∏–º–µ—Ä—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è:**

*–ü—Ä–∏–º–µ—Ä 1:*
- User: "–ö–Ω–∏–≥–∞ '1984' –∞–≤—Ç–æ—Ä–∞ –î–∂–æ—Ä–¥–∂ –û—Ä—É—ç–ª–ª, –∂–∞–Ω—Ä –∞–Ω—Ç–∏—É—Ç–æ–ø–∏—è, –≥–æ–¥ –∏–∑–¥–∞–Ω–∏—è 1949"
- Assistant:
```json
{
  "title": "1984",
  "author": "–î–∂–æ—Ä–¥–∂ –û—Ä—É—ç–ª–ª",
  "genre": "–∞–Ω—Ç–∏—É—Ç–æ–ø–∏—è",
  "year": 1949
}
```

*–ü—Ä–∏–º–µ—Ä 2:*
- User: "–ö–Ω–∏–≥–∞ '–ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞' –∞–≤—Ç–æ—Ä–∞ –ú–∏—Ö–∞–∏–ª –ë—É–ª–≥–∞–∫–æ–≤, –∂–∞–Ω—Ä —Ä–æ–º–∞–Ω, –≥–æ–¥ –∏–∑–¥–∞–Ω–∏—è 1967"
- Assistant:
```json
{
  "title": "–ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞",
  "author": "–ú–∏—Ö–∞–∏–ª –ë—É–ª–≥–∞–∫–æ–≤",
  "genre": "—Ä–æ–º–∞–Ω",
  "year": 1967
}
```

**–†–µ–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å:**
```
–ö–Ω–∏–≥–∞ '–ì—Ä–∞—Ñ –ú–æ–Ω—Ç–µ-–ö—Ä–∏—Å—Ç–æ' –∞–≤—Ç–æ—Ä–∞ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –î—é–º–∞, –∂–∞–Ω—Ä –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è, –≥–æ–¥ –∏–∑–¥–∞–Ω–∏—è 1844
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "title": "–ì—Ä–∞—Ñ –ú–æ–Ω—Ç–µ-–ö—Ä–∏—Å—Ç–æ",
  "author": "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –î—é–º–∞",
  "genre": "–ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è",
  "year": 1844
}
```

**–®–∞–±–ª–æ–Ω –∫–æ–¥–∞:**
```python
messages = [
    {
        'role': 'system',
        'content': '–¢—ã –ø–æ–º–æ—â–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è –∫–Ω–∏–≥ –≤ JSON —Ñ–æ—Ä–º–∞—Ç'
    },
    # –ü—Ä–∏–º–µ—Ä 1 - user
    {
        'role': 'user',
        'content': "–ö–Ω–∏–≥–∞ '1984' –∞–≤—Ç–æ—Ä–∞ –î–∂–æ—Ä–¥–∂ –û—Ä—É—ç–ª–ª, –∂–∞–Ω—Ä –∞–Ω—Ç–∏—É—Ç–æ–ø–∏—è, –≥–æ–¥ –∏–∑–¥–∞–Ω–∏—è 1949"
    },
    # –ü—Ä–∏–º–µ—Ä 1 - assistant
    {
        'role': 'assistant',
        'content': '''{"title": "1984", "author": "–î–∂–æ—Ä–¥–∂ –û—Ä—É—ç–ª–ª", "genre": "–∞–Ω—Ç–∏—É—Ç–æ–ø–∏—è", "year": 1949}'''
    },
    # –ü—Ä–∏–º–µ—Ä 2 - user
    # ... –¥–æ–±–∞–≤—å—Ç–µ –≤—Ç–æ—Ä–æ–π –ø—Ä–∏–º–µ—Ä ...

    # –†–µ–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å
    {
        'role': 'user',
        'content': "–ö–Ω–∏–≥–∞ '–ì—Ä–∞—Ñ –ú–æ–Ω—Ç–µ-–ö—Ä–∏—Å—Ç–æ' –∞–≤—Ç–æ—Ä–∞ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –î—é–º–∞, –∂–∞–Ω—Ä –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è, –≥–æ–¥ –∏–∑–¥–∞–Ω–∏—è 1844"
    }
]

response = client.chat.completions.create(
    model=os.getenv("BASE_MODEL"),
    messages=messages
)

print(response.choices[0].message.content)
```

---

## –ß–∞—Å—Ç—å 4: Multi-Turn Conversation (25 –º–∏–Ω—É—Ç)

### –ó–∞–¥–∞—á–∞ 4.1: –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π —á–∞—Ç-–±–æ—Ç –ø–æ Python

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**

–°–æ–∑–¥–∞–π—Ç–µ –¥–∏–∞–ª–æ–≥ —Å —á–∞—Ç-–±–æ—Ç–æ–º, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç –∏–∑—É—á–∞—Ç—å Python. –ë–æ—Ç –¥–æ–ª–∂–µ–Ω:
- –û—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ
- –ü–æ–º–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- –ü—Ä–∏–≤–æ–¥–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –∫–æ–≥–¥–∞ —ç—Ç–æ —É–º–µ—Å—Ç–Ω–æ

**–°—Ü–µ–Ω–∞—Ä–∏–π –¥–∏–∞–ª–æ–≥–∞ (–º–∏–Ω–∏–º—É–º 5 –æ–±–º–µ–Ω–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏):**

1. User: "–ß—Ç–æ —Ç–∞–∫–æ–µ —Å–ø–∏—Å–æ–∫ –≤ Python?"
2. User: "–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –≤ –Ω–µ–≥–æ?" (–±–æ—Ç –¥–æ–ª–∂–µ–Ω –ø–æ–Ω—è—Ç—å, —á—Ç–æ —Ä–µ—á—å –æ —Å–ø–∏—Å–∫–µ)
3. User: "–ê –∫–∞–∫ —É–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç?"
4. User: "–ü–æ–∫–∞–∂–∏ –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö —ç—Ç–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π"
5. User: "–°–ø–∞—Å–∏–±–æ! –¢–µ–ø–µ—Ä—å –æ–±—ä—è—Å–Ω–∏ —á—Ç–æ —Ç–∞–∫–æ–µ —Å–ª–æ–≤–∞—Ä—å"

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
=== –î–ò–ê–õ–û–ì –° –ß–ê–¢-–ë–û–¢–û–ú ===

USER: –ß—Ç–æ —Ç–∞–∫–æ–µ —Å–ø–∏—Å–æ–∫ –≤ Python?
ASSISTANT: [–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤]

USER: –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –≤ –Ω–µ–≥–æ?
ASSISTANT: [–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ append —Å —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ–º —Å–ø–∏—Å–∫–æ–≤ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞]

USER: –ê –∫–∞–∫ —É–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç?
ASSISTANT: [–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ remove/pop]

USER: –ü–æ–∫–∞–∂–∏ –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö —ç—Ç–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
ASSISTANT: [–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞]

USER: –°–ø–∞—Å–∏–±–æ! –¢–µ–ø–µ—Ä—å –æ–±—ä—è—Å–Ω–∏ —á—Ç–æ —Ç–∞–∫–æ–µ —Å–ª–æ–≤–∞—Ä—å
ASSISTANT: [–û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å–ª–æ–≤–∞—Ä–µ–π]

=== –°–¢–ê–¢–ò–°–¢–ò–ö–ê ===
–í—Å–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∏—Å—Ç–æ—Ä–∏–∏: 11 (1 system + 5 user + 5 assistant)
–í—Ö–æ–¥–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞: XXX
–í—ã—Ö–æ–¥–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞: XXX
```

**–®–∞–±–ª–æ–Ω –∫–æ–¥–∞:**
```python
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
messages = [
    {
        'role': 'system',
        'content': '''–¢—ã —Ç–µ—Ä–ø–µ–ª–∏–≤—ã–π –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å Python. –û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ.
        –ü—Ä–∏–≤–æ–¥–∏ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –∫–æ–≥–¥–∞ —ç—Ç–æ —É–º–µ—Å—Ç–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤.'''
    }
]

# –°–ø–∏—Å–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
user_questions = [
    "–ß—Ç–æ —Ç–∞–∫–æ–µ —Å–ø–∏—Å–æ–∫ –≤ Python?",
    "–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –≤ –Ω–µ–≥–æ?",
    "–ê –∫–∞–∫ —É–¥–∞–ª–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç?",
    "–ü–æ–∫–∞–∂–∏ –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö —ç—Ç–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π",
    "–°–ø–∞—Å–∏–±–æ! –¢–µ–ø–µ—Ä—å –æ–±—ä—è—Å–Ω–∏ —á—Ç–æ —Ç–∞–∫–æ–µ —Å–ª–æ–≤–∞—Ä—å"
]

print("=== –î–ò–ê–õ–û–ì –° –ß–ê–¢-–ë–û–¢–û–ú ===\n")

# –¶–∏–∫–ª –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–∞–∂–¥–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
for question in user_questions:
    # –î–æ–±–∞–≤—å—Ç–µ –≤–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∏—Å—Ç–æ—Ä–∏—é
    # –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≤–µ—Å—å messages —Å–ø–∏—Å–æ–∫ –≤ API
    # –ü–æ–ª—É—á–∏—Ç–µ –æ—Ç–≤–µ—Ç
    # –î–æ–±–∞–≤—å—Ç–µ –æ—Ç–≤–µ—Ç –≤ –∏—Å—Ç–æ—Ä–∏—é
    # –í—ã–≤–µ–¥–∏—Ç–µ –¥–∏–∞–ª–æ–≥
    pass

# –í—ã–≤–µ–¥–∏—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
print("\n=== –°–¢–ê–¢–ò–°–¢–ò–ö–ê ===")
print(f"–í—Å–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∏—Å—Ç–æ—Ä–∏–∏: {len(messages)}")
# –î–æ–±–∞–≤—å—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–∫–µ–Ω–∞—Ö –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
```

### –ó–∞–¥–∞—á–∞ 4.2: –ê–Ω–∞–ª–∏–∑ —Ä–æ—Å—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**

–ò—Å–ø–æ–ª—å–∑—É—è –¥–∏–∞–ª–æ–≥ –∏–∑ –∑–∞–¥–∞—á–∏ 4.1, –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –∫–∞–∫ —Ä–∞—Å—Ç–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ö–æ–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ —Å –∫–∞–∂–¥—ã–º –Ω–æ–≤—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º.

1. –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ö–æ–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
2. –ü–æ—Å—Ç—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É —Ä–æ—Å—Ç–∞
3. –†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∏ –æ–±—â—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–∏–∞–ª–æ–≥–∞

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
=== –ê–ù–ê–õ–ò–ó –†–û–°–¢–ê –¢–û–ö–ï–ù–û–í ===
–ó–∞–ø—Ä–æ—Å | –í—Ö–æ–¥–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã | –í—ã—Ö–æ–¥–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã | –°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞
-------|----------------|-----------------|------------------
   1   |      45        |       78        | $0.00000154
   2   |      98        |       65        | $0.00000186
   3   |     145        |       52        | $0.00000053
   4   |     181        |      120        | $0.00000099
   5   |     285        |       95        | $0.00000100

=== –ò–¢–û–ì–û ===
–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–∏–∞–ª–æ–≥–∞: $0.00000592
–°—Ä–µ–¥–Ω–∏–π —Ä–æ—Å—Ç –≤—Ö–æ–¥–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ –∑–∞ –∑–∞–ø—Ä–æ—Å: XX —Ç–æ–∫–µ–Ω–æ–≤
```

**–®–∞–±–ª–æ–Ω –∫–æ–¥–∞:**
```python
messages = [{'role': 'system', 'content': '...'}]
user_questions = [...]

# –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
stats = []

input_token_price = 0.15 / 1000000
output_token_price = 0.60 / 1000000

for i, question in enumerate(user_questions, 1):
    messages.append({'role': 'user', 'content': question})

    response = client.chat.completions.create(
        model=os.getenv("BASE_MODEL"),
        messages=messages
    )

    # –°–æ–±–µ—Ä–∏—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    input_tokens = response.usage.prompt_tokens
    output_tokens = response.usage.completion_tokens
    cost = (input_tokens * input_token_price) + (output_tokens * output_token_price)

    stats.append({
        'request': i,
        'input_tokens': input_tokens,
        'output_tokens': output_tokens,
        'cost': cost
    })

    messages.append({
        'role': 'assistant',
        'content': response.choices[0].message.content
    })

# –í—ã–≤–µ–¥–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É –∏ –∏—Ç–æ–≥–∏
print("=== –ê–ù–ê–õ–ò–ó –†–û–°–¢–ê –¢–û–ö–ï–ù–û–í ===")
# –í–∞—à –∫–æ–¥ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞
```

---

## –ß–∞—Å—Ç—å 5 (–ë–æ–Ω—É—Å): –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª–∏–Ω–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤ (20 –º–∏–Ω—É—Ç)

### –ó–∞–¥–∞—á–∞ 5.1: –°—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏

**–°—Ü–µ–Ω–∞—Ä–∏–π**: –£ –≤–∞—Å –µ—Å—Ç—å –¥–ª–∏–Ω–Ω—ã–π –¥–∏–∞–ª–æ–≥ (10+ —Å–æ–æ–±—â–µ–Ω–∏–π), –∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å, —Å–æ—Ö—Ä–∞–Ω—è—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å–æ–æ–±—â–µ–Ω–∏–π.

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**

1. –°–æ–∑–¥–∞–π—Ç–µ –¥–∏–∞–ª–æ–≥ –∏–∑ 10 –≤–æ–ø—Ä–æ—Å–æ–≤ –æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏
2. –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `limit_history(messages, max_messages)`, –∫–æ—Ç–æ—Ä–∞—è:
   - –í—Å–µ–≥–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–ø–µ—Ä–≤–æ–µ)
   - –û—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ `max_messages` –ø–∞—Ä user-assistant
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É—Å–µ—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫

3. –°—Ä–∞–≤–Ω–∏—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏ —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏—è—Ö:
   - –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è (–≤—Å–µ 10 —Å–æ–æ–±—â–µ–Ω–∏–π)
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ 5 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø–∞—Ä
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ 3 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø–∞—Ä

**–°–ø–∏—Å–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤:**
```python
questions = [
    "–ß—Ç–æ —Ç–∞–∫–æ–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è?",
    "–ö–∞–∫–∏–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å –≤ Python?",
    "–ß—Ç–æ —Ç–∞–∫–æ–µ —É—Å–ª–æ–≤–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä if?",
    "–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ü–∏–∫–ª for?",
    "–ß—Ç–æ —Ç–∞–∫–æ–µ —Ñ—É–Ω–∫—Ü–∏—è?",
    "–ö–∞–∫ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ —Ñ—É–Ω–∫—Ü–∏—é?",
    "–ß—Ç–æ —Ç–∞–∫–æ–µ —Å–ø–∏—Å–æ–∫?",
    "–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å?",
    "–ß—Ç–æ —Ç–∞–∫–æ–µ –∫–ª–∞—Å—Å—ã?",
    "–û–±—ä—è—Å–Ω–∏ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ"
]
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
=== –°–†–ê–í–ù–ï–ù–ò–ï –°–¢–†–ê–¢–ï–ì–ò–ô ===

–°–¢–†–ê–¢–ï–ì–ò–Ø 1: –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è (10 –ø–∞—Ä)
–¢–æ–∫–µ–Ω–æ–≤ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º –∑–∞–ø—Ä–æ—Å–µ: XXX
–°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞: $0.000XXX

–°–¢–†–ê–¢–ï–ì–ò–Ø 2: –ü–æ—Å–ª–µ–¥–Ω–∏–µ 5 –ø–∞—Ä
–¢–æ–∫–µ–Ω–æ–≤ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º –∑–∞–ø—Ä–æ—Å–µ: XXX
–°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞: $0.000XXX
–≠–∫–æ–Ω–æ–º–∏—è: XX%

–°–¢–†–ê–¢–ï–ì–ò–Ø 3: –ü–æ—Å–ª–µ–¥–Ω–∏–µ 3 –ø–∞—Ä—ã
–¢–æ–∫–µ–Ω–æ–≤ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º –∑–∞–ø—Ä–æ—Å–µ: XXX
–°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞: $0.000XXX
–≠–∫–æ–Ω–æ–º–∏—è: XX%

=== –í–´–í–û–î ===
–û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞: [–≤–∞—à –∞–Ω–∞–ª–∏–∑]
```

**–®–∞–±–ª–æ–Ω –∫–æ–¥–∞:**
```python
def limit_history(messages, max_pairs):
    """
    –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –¥–∏–∞–ª–æ–≥–∞.

    Args:
        messages: –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π
        max_pairs: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä user-assistant –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

    Returns:
        –£—Å–µ—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫: [system] + –ø–æ—Å–ª–µ–¥–Ω–∏–µ max_pairs –ø–∞—Ä
    """
    # –í–∞—à –∫–æ–¥
    pass

questions = [...]

# –¢–µ—Å—Ç —Ç—Ä–µ—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
strategies = {
    "–ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è": None,  # –ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
    "–ü–æ—Å–ª–µ–¥–Ω–∏–µ 5 –ø–∞—Ä": 5,
    "–ü–æ—Å–ª–µ–¥–Ω–∏–µ 3 –ø–∞—Ä—ã": 3
}

results = {}

for strategy_name, limit in strategies.items():
    messages = [{'role': 'system', 'content': '...'}]

    # –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –≤–µ—Å—å –¥–∏–∞–ª–æ–≥
    for q in questions:
        # ... –¥–æ–±–∞–≤—å—Ç–µ –≤–æ–ø—Ä–æ—Å –∏ –ø–æ–ª—É—á–∏—Ç–µ –æ—Ç–≤–µ—Ç ...

        # –î–ª—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–∏–º–µ–Ω–∏—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –µ—Å–ª–∏ –∑–∞–¥–∞–Ω–æ
        if q == questions[-1] and limit is not None:
            messages = limit_history(messages, limit)
            # –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—Ä–æ—Å —Å —É—Å–µ—á–µ–Ω–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π
            pass

    # –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    # results[strategy_name] = {...}

# –í—ã–≤–µ–¥–∏—Ç–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
```

---

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏

| –ß–∞—Å—Ç—å | –ë–∞–ª–ª—ã | –ö—Ä–∏—Ç–µ—Ä–∏–π |
|-------|-------|----------|
| –ß–∞—Å—Ç—å 1 | 15 | –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Å–∏—Å—Ç–µ–º–Ω–æ–π —Ä–æ–ª—å—é, —Ç—Ä–∏ —Ä–∞–∑–Ω—ã—Ö —Å—Ç–∏–ª—è –æ–±—â–µ–Ω–∏—è |
| –ß–∞—Å—Ç—å 2 | 20 | –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥—Ä–∞–Ω–∏—Ü, –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –æ—Ç–∫–∞–∑—ã –Ω–∞ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã |
| –ß–∞—Å—Ç—å 3 | 20 | Few-shot prompting —á–µ—Ä–µ–∑ —Ä–æ–ª–∏, —Ç–æ—á–Ω–æ–µ —Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç—É JSON |
| –ß–∞—Å—Ç—å 4.1 | 20 | –°–æ–∑–¥–∞–Ω–∏–µ multi-turn –¥–∏–∞–ª–æ–≥–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ |
| –ß–∞—Å—Ç—å 4.2 | 15 | –ê–Ω–∞–ª–∏–∑ —Ä–æ—Å—Ç–∞ —Ç–æ–∫–µ–Ω–æ–≤ –∏ —Ä–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ |
| –ß–∞—Å—Ç—å 5 | 10 | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤ |
| **–í—Å–µ–≥–æ** | **100** | |

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é

1. **–ü—Ä–æ–¥—É–º—ã–≤–∞–π—Ç–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è**: –ß–µ–º —Ç–æ—á–Ω–µ–µ –≤—ã –æ–ø–∏—à–µ—Ç–µ —Ä–æ–ª—å –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, —Ç–µ–º –ª—É—á—à–µ –±—É–¥–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
2. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≥—Ä–∞–Ω–∏—Ü—ã**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–∞—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
3. **–ò–∑—É—á–∞–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É messages**: –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–æ–≥–æ, –∫–∞–∫ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è multi-turn –¥–∏–∞–ª–æ–≥–æ–≤
4. **–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Ç–æ–∫–µ–Ω—ã**: –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ `response.usage` –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏
5. **–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ**: –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
6. **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –ø—Ä–∏–º–µ—Ä—ã**: –£–¥–∞—á–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–∏–∞–ª–æ–≥–æ–≤ –ø—Ä–∏–≥–æ–¥—è—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö

## –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏

‚ùå **–û—à–∏–±–∫–∞ 1**: –°–ª–∏—à–∫–æ–º –æ–±—â–µ–µ —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
```python
# –ü–ª–æ—Ö–æ
"–¢—ã –ø–æ–º–æ—â–Ω–∏–∫"

# –•–æ—Ä–æ—à–æ
"–¢—ã –ø–æ–º–æ—â–Ω–∏–∫ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –∫–ª–∏–Ω–∏–∫–∏. –ü–æ–º–æ–≥–∞–µ—à—å —Å –∑–∞–ø–∏—Å—å—é –Ω–∞ –ø—Ä–∏–µ–º, –Ω–æ –ù–ï –¥–∞–µ—à—å –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã"
```

‚ùå **–û—à–∏–±–∫–∞ 2**: –ó–∞–±—ã–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏ –≤ –∏—Å—Ç–æ—Ä–∏—é
```python
# –í–∞—à –∫–æ–¥ –¥–æ–ª–∂–µ–Ω –¥–æ–±–∞–≤–ª—è—Ç—å –ö–ê–ñ–î–´–ô –æ—Ç–≤–µ—Ç –≤ messages
messages.append({'role': 'assistant', 'content': response.choices[0].message.content})
```

‚ùå **–û—à–∏–±–∫–∞ 3**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ–ø–æ–ª–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ç–æ–∫–µ–Ω–æ–≤
```python
# –î–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ä–æ—Å—Ç–∞ —Ç–æ–∫–µ–Ω–æ–≤ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –í–°–Æ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é
response = client.chat.completions.create(
    model=os.getenv("BASE_MODEL"),
    messages=messages  # –í–µ—Å—å —Å–ø–∏—Å–æ–∫, –Ω–µ –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ!
)
```

## –ß—Ç–æ –≤—ã –æ—Å–≤–æ–∏—Ç–µ

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –≤—ã —Å–º–æ–∂–µ—Ç–µ:
- ‚úÖ –£–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º –∏ —Å—Ç–∏–ª–µ–º –æ—Ç–≤–µ—Ç–æ–≤ –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—É—é —Ä–æ–ª—å
- ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —á–µ—Ç–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —á–∞—Ç-–±–æ—Ç–æ–≤
- ‚úÖ –ü—Ä–∏–º–µ–Ω—è—Ç—å few-shot prompting —á–µ—Ä–µ–∑ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∏–∞–ª–æ–≥–∏ user-assistant
- ‚úÖ –°–æ–∑–¥–∞–≤–∞—Ç—å –º–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- ‚úÖ –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–ª–∏–Ω–Ω—ã—Ö —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤
- ‚úÖ –í—ã–±–∏—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–µ–π –¥–∏–∞–ª–æ–≥–∞
- ‚úÖ –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ

–ù–∞–≤—ã–∫–∏ –∏–∑ —ç—Ç–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã –¥–ª—è:
- ü§ñ –†–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —á–∞—Ç-–±–æ—Ç–æ–≤ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤
- üìö –°–æ–∑–¥–∞–Ω–∏—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö AI-–ø–æ–º–æ—â–Ω–∏–∫–æ–≤
- üíº –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–æ–≤ (HR, —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ, –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ)
- üéØ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞—Ç—Ä–∞—Ç –Ω–∞ API –≤ production –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö
- üîß –°–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö AI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Å –ø–∞–º—è—Ç—å—é –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

---

**–£–¥–∞—á–∏ –≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–¥–∞–Ω–∏—è! üöÄ**

*–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º [[OpenAI_API/Chat_Roles_and_Multi_Turn_Conversations|–†–æ–ª–∏ –≤ —á–∞—Ç–∞—Ö –∏ –º–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏]]*
